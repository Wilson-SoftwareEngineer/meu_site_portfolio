{% load static %}
<!DOCTYPE html>
<html class="dark" lang="pt-BR">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Piauí Tech Hub </title>
    
    <link rel="stylesheet" href="{% static 'css/style.css' %}">

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    
    <link href="https://fonts.googleapis.com" rel="preconnect"/>
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300..700&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet"/>
    
    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              "primary": "#0d59f2",
              "background-light": "#f5f6f8",
              "background-dark": "#101622",
            },
            fontFamily: {
              "display": ["Space Grotesk", "sans-serif"]
            },
            borderRadius: {"DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px"},
          },
        },
      }
    </script>
</head>
</div>

<body class="bg-background-light dark:bg-background-dark font-display text-gray-800 dark:text-gray-200">
    <button id="chat-toggle" class="fixed bottom-6 right-6 bg-primary text-white p-4 rounded-full shadow-lg hover:bg-blue-700 transition-all z-50 flex items-center justify-center w-14 h-14 cursor-pointer">
        <span class="material-symbols-outlined text-2xl">chat</span>
    </button>

    <div id="chat-window" class="fixed bottom-24 right-6 w-80 bg-[#1a2336] rounded-xl shadow-2xl border border-white/10 z-50 hidden flex flex-col overflow-hidden">
        <div class="bg-primary p-4 flex justify-between items-center">
            <h3 class="text-white font-bold">Assistente Tech</h3>
            <button id="chat-close" class="text-white hover:text-gray-200 cursor-pointer">
                <span class="material-symbols-outlined">close</span>
            </button>
        </div>
        
        <div id="chat-messages" class="h-80 p-4 overflow-y-auto bg-[#101622] flex flex-col gap-3">
            <div class="self-start bg-[#1a2336] text-gray-200 p-3 rounded-lg rounded-tl-none border border-white/5 text-sm max-w-[80%]">
                Olá! Sou a IA do Piauí Tech Hub. Represento o Eng. Wilson. Posso ajuda-lo?
            </div>
        </div>

        <div class="p-3 bg-[#1a2336] border-t border-white/10 flex gap-2">
            <input 
                id="user-input" 
                type="text" 
                placeholder="Digite sua dúvida..." 
                class="w-full bg-[#101622] text-white text-sm rounded-lg px-3 py-2 border border-white/10 focus:outline-none focus:border-primary"
                onkeydown="if(event.key === 'Enter') sendMessage()"
            >
            
            <button 
                id="send-btn" 
                onclick="sendMessage()" 
                class="text-primary hover:text-white p-2 transition-colors cursor-pointer"
            >
                <span class="material-symbols-outlined">send</span>
            </button>
        </div>
    </div>
    

    <div class="relative flex h-auto min-h-screen w-full flex-col overflow-x-hidden">
        <div class="layout-container flex h-full grow flex-col">
            <div class="flex flex-1 justify-center py-5">
                <div class="layout-content-container flex w-full flex-col max-w-[1100px] px-4">
                    
                    <header class="flex items-center justify-between whitespace-nowrap border-b border-solid border-white/10 px-4 sm:px-10 py-3 sticky top-0 z-50 bg-background-dark/80 backdrop-blur-sm">
    
    <div class="flex items-center gap-3 text-white">
        <img src="{% static 'imagens/logopitech.png' %}" alt="Logo" class="h-8 w-auto"> 
        <h2 class="text-white text-lg font-bold leading-tight">Piauí Tech Hub</h2>
    </div>

    <nav class="hidden lg:flex flex-1 justify-end gap-8">
        <div class="flex items-center gap-9">
            <a class="text-white text-sm font-medium leading-normal hover:text-primary transition-colors" href="{% url 'home' %}">Home</a>
            
            <a class="text-white text-sm font-medium leading-normal hover:text-primary transition-colors" href="{% url 'engenharia_software' %}">Engenharia de Software</a>
            
            <div class="relative group">
                <a class="text-white text-sm font-medium leading-normal flex items-center gap-1 cursor-pointer hover:text-primary transition-colors" href="#">
                    <span>Hub de Conhecimento</span>
                    <span class="material-symbols-outlined text-base transition-transform group-hover:rotate-180">expand_more</span>
                </a>
                
                <div class="absolute top-full left-1/2 -translate-x-1/2 mt-2 w-48 bg-[#1a2336] border border-white/10 rounded-lg shadow-lg p-2 hidden group-hover:flex flex-col gap-1">
                    <a class="block px-3 py-2 text-sm text-white/80 hover:bg-primary/30 hover:text-white rounded" href="#">Tutoriais</a>
                    <a class="block px-3 py-2 text-sm text-white/80 hover:bg-primary/30 hover:text-white rounded" href="#">Guias Completos</a>
                    <a class="block px-3 py-2 text-sm text-white/80 hover:bg-primary/30 hover:text-white rounded" href="#">Ferramentas</a>
                </div>
            </div>

            <a class="text-white text-sm font-medium leading-normal hover:text-primary transition-colors" href="#">Atualidades Tech</a>
            <a class="text-white text-sm font-medium leading-normal hover:text-primary transition-colors" href="#hall-da-fama">Hall da Fama</a>
        </div>
    </nav>

    <button class="lg:hidden text-white">
        <span class="material-symbols-outlined">menu</span>
    </button>
</header>

                    <main class="flex-grow">
                        <section class="my-10 @container">
                            <div class="@[480px]:p-4">
                                <div class="flex min-h-[480px] flex-col gap-6 bg-cover bg-center bg-no-repeat @[480px]:gap-8 @[480px]:rounded-xl items-center justify-center p-4" 
                                     style='background-image: linear-gradient(rgba(16, 22, 34, 0.7) 0%, rgba(16, 22, 34, 0.9) 100%), url("https://images.unsplash.com/photo-1518770660439-4636190af475?q=80&w=2070&auto=format&fit=crop");'>
                                    <div class="flex flex-col gap-2 text-center max-w-2xl">
                                        <h1 class="text-white text-4xl font-black leading-tight tracking-[-0.033em] @[480px]:text-5xl @[480px]:font-black @[480px]:leading-tight @[480px]:tracking-[-0.033em]">Construindo o Futuro Digital.</h1>
                                        <h2 class="text-gray-300 text-sm font-normal leading-normal @[480px]:text-base @[480px]:font-normal @[480px]:leading-normal">Seu hub de conhecimento em Engenharia de Software e Tecnologia.</h2>
                                    </div>
                                    <button class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 @[480px]:h-12 @[480px]:px-5 bg-primary text-white text-sm font-bold leading-normal tracking-[0.015em] @[480px]:text-base @[480px]:font-bold @[480px]:leading-normal @[480px]:tracking-[0.015em] hover:bg-blue-600 transition-colors">
                                        <span class="truncate">Explore o Hub</span>
                                    </button>
                                </div>
                            </div>
                        </section>

                        <section class="my-10">
                            <h2 class="text-white text-3xl font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5 border-b-2 border-primary/50 inline-block">Últimas Publicações</h2>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 p-4 mt-4">
    {% for post in posts %}
    <div class="flex flex-col gap-3 pb-3 bg-[#1a2336] rounded-xl overflow-hidden group border border-transparent hover:border-primary/50 transition-all">
        
        <div class="w-full bg-center bg-no-repeat aspect-video bg-cover" 
             style='background-image: url("{{ post.imagem.url }}");'></div>

        <div class="p-4 flex flex-col flex-grow">
            <p class="text-primary text-xs font-bold uppercase tracking-wider mb-2">
                {{ post.categoria }}
            </p>
            
            <p class="text-white text-xl font-medium leading-normal">
                {{ post.titulo }}
            </p>
            
            <p class="text-[#90a4cb] text-sm font-normal leading-normal mt-2 flex-grow">
                {{ post.subtitulo }}
            </p>
            
            <a class="text-primary text-sm font-bold mt-4 inline-flex items-center gap-2 group-hover:gap-3 transition-all" 
               href="{% url 'post_detail' post.id %}">
               Leia Mais <span class="material-symbols-outlined">arrow_forward</span>
            </a>
        </div>
    </div>
    {% endfor %}
</div>
                            
                            <div class="flex px-4 py-8 justify-center">
                                <button class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-[#222f49] text-white text-sm font-bold leading-normal tracking-[0.015em] hover:bg-[#2e3f61] transition-colors">
                                    <span class="truncate">Ver todos os artigos</span>
                                </button>
                            </div>
                        </section>

                        <section class="my-10 py-16 bg-[#1a2336] rounded-xl">
                          <section class="my-16 px-4 sm:px-10" id="sobre-mim">
    <div class="bg-[#1a2336] rounded-2xl p-8 md:p-12 border border-white/5 overflow-hidden relative">
        <div class="absolute top-0 right-0 -mr-20 -mt-20 w-64 h-64 bg-primary/10 rounded-full blur-3xl"></div>
        
        <div class="grid md:grid-cols-2 gap-12 items-center relative z-10">
            
            <div class="order-2 md:order-1 flex justify-center md:justify-start">
                <div class="relative group">
                    <div class="absolute -inset-1 bg-gradient-to-r from-primary to-blue-400 rounded-xl blur opacity-25 group-hover:opacity-50 transition duration-1000 group-hover:duration-200"></div>
                    
                    <img 
                       src="{% static 'imagens/software_engineer.png' %}" 
                       alt="Wilson - Engenheiro de Software em formação" 
                       class="relative w-full max-w-sm rounded-xl shadow-2xl border border-white/10 object-cover transform transition-transform duration-500 group-hover:scale-[1.01]"
                    >
                </div>
            </div>

            <div class="order-1 md:order-2 flex flex-col gap-6 text-left">
                <div>
                    <h2 class="text-primary text-sm font-bold uppercase tracking-wider mb-2">Portfolio</h2>
                    <h3 class="text-white text-3xl md:text-4xl font-bold leading-tight">Sobre Mim</h3>
                    <div class="w-24 h-1.5 bg-primary rounded-full mt-4"></div>
                </div>

                <div class="space-y-4 text-gray-300 text-lg leading-relaxed text-justify">
                    <p>
                        <strong class="text-white">Wilson</strong> é um estudante de Engenharia de Software em transição de carreira.
                    </p>
                    <p>
                        Este site é parte de seu portfolio de apresentação pessoal, bem como um projeto que vem sendo construído ao longo de sua trajetória de estudos. Atualmente programa em Java com SpringBoot, Python(Django), HTML, CSS e JavaScript. Também é construtor de Agentes de IA com n8n.
                    </p>
                </div>

                <div class="pt-4">
                    <a href="https://www.linkedin.com/in/wilson-sousa-826b8b245/" target="_blank" class="inline-flex items-center justify-center gap-2 px-6 py-3 bg-primary hover:bg-blue-600 text-white font-bold rounded-lg transition-colors group">
                    Entrar em contato
                    <span class="material-symbols-outlined group-hover:translate-x-1 transition-transform">open_in_new</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>
                        <section class="my-16 px-4" id="hall-da-fama">
                            <div class="text-center mb-12">
                                <h2 class="text-white text-3xl font-bold leading-tight tracking-[-0.015em] pb-3 border-b-2 border-primary inline-block">Hall da Fama da Computação</h2>
                                <p class="text-gray-400 mt-4 max-w-2xl mx-auto">Conheça os visionários, cientistas e criadores que transformaram linhas de código e circuitos na revolução digital que vivemos hoje.</p>
                            </div>

                            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                                {% for membro in membros %}
                                <div class="bg-[#1a2336] rounded-xl p-6 flex flex-col items-center text-center border border-transparent hover:border-primary/50 transition-all group hover:-translate-y-1 duration-300">
                                    <div class="w-32 h-32 mb-4 rounded-full overflow-hidden border-4 border-primary/20 group-hover:border-primary transition-colors flex-shrink-0">
    {% if membro.imagem %}
        <img src="{{ membro.imagem.url }}" alt="{{ membro.nome }}" class="w-full h-full object-cover object-center">
    {% else %}
        <div class="w-full h-full bg-gray-700 flex items-center justify-center text-white text-xs">Sem Foto</div>
    {% endif %}
</div>

<h3 class="text-xl font-bold text-white mt-2">{{ membro.nome }}</h3>
<span class="text-primary text-xs font-bold uppercase tracking-wider mb-3 block">{{ membro.titulo }}</span>
<p class="text-gray-400 text-sm leading-relaxed text-center">{{ membro.descricao }}</p>
                                </div>
                                {% endfor %}
                                </div>
                        </section>

                        <div class="grid md:grid-cols-2 gap-8 items-center px-4 sm:px-10">
                            <div class="flex flex-col gap-4 text-left">
                                <h2 class="text-white text-3xl font-bold leading-tight tracking-[-0.015em]">Nossa Missão</h2>
                                <p class="text-gray-300 leading-relaxed">Nosso objetivo é compartilhar conhecimentos, descobertas, dúvidas e soluções, com todos os envolvidos e entusiastas da Engenharia de Software.</p>
                                <p class="text-gray-300 leading-relaxed text-justify">Do iniciante ao especialista, esperamos apresentar análises das últimas tendências para orientar a próxima geração de engenheiros de software.</p>
                            </div>
                            <div class="w-full">
                                <img alt="Equipe de tecnologia colaborando" class="rounded-lg object-cover w-full h-full aspect-square md:aspect-auto" src="https://images.unsplash.com/photo-1522071820081-009f0129c71c?q=80&w=2070&auto=format&fit=crop"/>
                            </div>
                        </div>
                        </section>
                    </main>

                    <footer class="mt-10 border-t border-solid border-white/10 px-4 sm:px-10 py-8">
                        <div class="flex items-center gap-3">
                          <img src="{% static 'imagens/logopitech.png' %}" alt="Logo" class="h-6 w-auto">
    
                          <h2 class="text-white text-lg font-bold">Piauí Tech Hub</h2>
                         </div>
                         <p class="text-gray-400 text-sm mt-2">Aqui os desenvolvedores se sentem em casa</p>    </div>
                            <div>
                                <h3 class="text-white font-semibold mb-3">Mapa do Site</h3>
                                <ul class="space-y-2">
                                    <li><a class="text-gray-400 hover:text-primary text-sm transition-colors" href="#">Home</a></li>
                                    <li><a class="text-gray-400 hover:text-primary text-sm transition-colors" href="#">Engenharia de Software</a></li>
                                    <li><a class="text-gray-400 hover:text-primary text-sm transition-colors" href="#">Hub de Conhecimento</a></li>
                                    <li><a class="text-gray-400 hover:text-primary text-sm transition-colors" href="#">Política de Privacidade</a></li>
                                </ul>
                            </div>
                            <div>
                                <h3 class="text-white font-semibold mb-3">Siga-nos</h3>
                                <div class="flex items-center gap-4">
                                    <a class="text-gray-400 hover:text-primary transition-colors" href="#"><svg class="h-6 w-6" fill="currentColor" viewbox="0 0 24 24"><path d="M22.46,6C21.69,6.35 20.86,6.58 20,6.69C20.88,6.16 21.56,5.32 21.88,4.31C21.05,4.81 20.13,5.16 19.16,5.36C18.37,4.5 17.26,4 16,4C13.65,4 11.73,5.92 11.73,8.29C11.73,8.63 11.77,8.96 11.84,9.27C8.28,9.09 5.11,7.38 2.9,4.79C2.53,5.42 2.33,6.16 2.33,6.94C2.33,8.43 3.11,9.75 4.26,10.54C3.54,10.51 2.87,10.31 2.3,10.01C2.3,10.03 2.3,10.05 2.3,10.07C2.3,12.17 3.81,13.95 5.83,14.34C5.47,14.44 5.1,14.5 4.72,14.5C4.46,14.5 4.21,14.48 3.96,14.43C4.5,16.14 6.04,17.38 7.89,17.42C6.39,18.61 4.5,19.23 2.5,19.23C2.17,19.23 1.84,19.21 1.51,19.17C3.38,20.39 5.64,21.08 8.06,21.08C16,21.08 20.34,14.48 20.34,8.81C20.34,8.64 20.34,8.47 20.33,8.3C21.14,7.73 21.88,7.01 22.46,6Z"></path></svg></a>
                                    <a class="text-gray-400 hover:text-primary transition-colors" href="#"><svg class="h-6 w-6" fill="currentColor" viewbox="0 0 24 24"><path d="M19,3A2,2 0 0,1 21,5V19A2,2 0 0,1 19,21H5A2,2 0 0,1 3,19V5A2,2 0 0,1 5,3H19M18.5,18.5V13.2A3.26,3.26 0 0,0 15.24,9.94C14.39,9.94 13.4,10.46 12.92,11.24V10.13H10.13V18.5H12.92V13.57C12.92,12.8 13.54,12.17 14.31,12.17A1.4,1.4 0 0,1 15.71,13.57V18.5H18.5M6.88,8.56A1.68,1.68 0 0,0 8.56,6.88C8.56,6 7.78,5.2 6.88,5.2A1.68,1.68 0 0,0 5.2,6.88C5.2,7.78 6,8.56 6.88,8.56M8.27,18.5V10.13H5.5V18.5H8.27Z"></path></svg></a>
                                    <a class="text-gray-400 hover:text-primary transition-colors" href="#"><svg class="h-6 w-6" fill="currentColor" viewbox="0 0 24 24"><path d="M12,2A10,10 0 0,0 2,12C2,16.42 4.87,20.17 8.84,21.5C9.34,21.58 9.5,21.27 9.5,21C9.5,20.77 9.5,20.14 9.5,19.31C6.73,19.91 6.14,17.97 6.14,17.97C5.68,16.81 5.03,16.5 5.03,16.5C4.12,15.88 5.1,15.9 5.1,15.9C6.1,15.97 6.63,16.93 6.63,16.93C7.5,18.45 8.97,18 9.54,17.76C9.63,17.11 9.89,16.67 10.17,16.42C7.95,16.17 5.62,15.31 5.62,11.5C5.62,10.39 6,9.5 6.65,8.79C6.55,8.54 6.2,7.5 6.75,6.15C6.75,6.15 7.59,5.88 9.5,7.17C10.29,6.95 11.15,6.84 12,6.84C12.85,6.84 13.71,6.95 14.5,7.17C16.41,5.88 17.25,6.15 17.25,6.15C17.8,7.5 17.45,8.54 17.35,8.79C18,9.5 18.38,10.39 18.38,11.5C18.38,15.32 16.04,16.16 13.81,16.41C14.17,16.72 14.5,17.33 14.5,18.26C14.5,19.6 14.5,20.68 14.5,21C14.5,21.27 14.66,21.59 15.17,21.5C19.14,20.16 22,16.42 22,12A10,10 0 0,0 12,2Z"></path></svg></a>
                                </div>
                            </div>
                        </div>
                        <div class="mt-8 pt-8 border-t border-solid border-white/10 text-center">
                            <p class="text-gray-500 text-sm">© 2026 Piauí Tech Hub. Todos os direitos reservados.</p>
                        </div>
                    </footer>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
<script>
    const chatToggle = document.getElementById('chat-toggle');
    const chatWindow = document.getElementById('chat-window');
    const chatClose = document.getElementById('chat-close');
    const messagesContainer = document.getElementById('chat-messages');
    const userInput = document.getElementById('user-input');
    const sendBtn = document.getElementById('send-btn');

    // Abrir e Fechar o Chat
    function toggleChat() {
        chatWindow.classList.toggle('hidden');
        // Foca no input quando abre
        if (!chatWindow.classList.contains('hidden')) {
            setTimeout(() => userInput.focus(), 100);
        }
    }

    chatToggle.addEventListener('click', toggleChat);
    chatClose.addEventListener('click', toggleChat);

    // Função Principal de Enviar
    async function sendMessage() {
        const text = userInput.value.trim();
        console.log("Tentando enviar:", text); // LOG PARA DEBUG

        if (!text) return;

        // 1. Adiciona mensagem do usuário
        addMessage(text, 'user');
        userInput.value = '';
        sendBtn.disabled = true;

        // 2. Balão de carregando
        const loadingId = addMessage('...', 'ai', true);

        try {
            // 3. Chama o servidor Django
            console.log("Enviando para /api/chat/..."); // LOG PARA DEBUG
            
            const response = await fetch('/api/chat/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': getCookie('csrftoken')
                },
                body: JSON.stringify({ message: text })
            });

            if (!response.ok) {
                throw new Error(`Erro HTTP: ${response.status}`);
            }

            const data = await response.json();
            console.log("Resposta recebida:", data); // LOG PARA DEBUG

            // 4. Mostra a resposta
            removeMessage(loadingId);
            addMessage(data.reply, 'ai');

        } catch (error) {
            console.error("Erro no envio:", error);
            removeMessage(loadingId);
            addMessage('Erro ao conectar. Verifique o terminal do servidor.', 'ai');
        }

        sendBtn.disabled = false;
        userInput.focus();
    }

    // Função visual para criar balões
    function addMessage(text, sender, isLoading = false) {
        const div = document.createElement('div');
        div.id = Date.now();
        
        if (sender === 'user') {
            div.className = "self-end bg-primary text-white p-3 rounded-lg rounded-tr-none text-sm max-w-[80%]";
        } else {
            div.className = "self-start bg-[#1a2336] text-gray-200 p-3 rounded-lg rounded-tl-none border border-white/5 text-sm max-w-[80%]";
            if (isLoading) div.classList.add('animate-pulse');
        }
        
        div.innerText = text;
        messagesContainer.appendChild(div);
        messagesContainer.scrollTop = messagesContainer.scrollHeight;
        return div.id;
    }

    function removeMessage(id) {
        const el = document.getElementById(id);
        if (el) el.remove();
    }

    // Pega o token de segurança do Django
    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
</script>